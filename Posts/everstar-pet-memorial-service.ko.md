---
title: EVER-STAR - Atomic Designê³¼ OpenViduë¡œ êµ¬ì¶•í•œ ë°˜ë ¤ë™ë¬¼ ì¶”ëª¨ ì„œë¹„ìŠ¤
description: React 18, 265ê°œ ì´ìƒì˜ ì»´í¬ë„ŒíŠ¸ë¥¼ ê°€ì§„ Atomic Design íŒ¨í„´, ì‹¤ì‹œê°„ í™”ìƒ ì±„íŒ…, í˜ì´ì§€ ë„˜ê¹€ ì• ë‹ˆë©”ì´ì…˜ì´ ìˆëŠ” ì¸í„°ë™í‹°ë¸Œ ì¶”ëª¨ ì±…ì„ ì‚¬ìš©í•˜ì—¬ ë°˜ë ¤ë™ë¬¼ ìƒì‹¤ì„ ìœ„í•œ ì¹˜ìœ  í”Œë«í¼ ê°œë°œ
date: 2025-01-15
tags:
  - React
  - Atomic Design
  - OpenVidu
  - Redux Toolkit
  - Spring Boot
category: Frontend
featured: false
---

# EVER-STAR: ë°˜ë ¤ë™ë¬¼ ìƒì‹¤ì„ ìœ„í•œ ë””ì§€í„¸ ì¹˜ìœ  ê³µê°„

> **ì˜ì›ë³„ (Eternal Star)** - ì¶”ëª¨ ê³µê°„
> **ì§€êµ¬ë³„ (Earth Star)** - í€˜ìŠ¤íŠ¸ì™€ í¸ì§€ë¥¼ í†µí•œ ì¸í„°ë™í‹°ë¸Œ ì¹˜ìœ  ì—¬ì •

## í”„ë¡œì íŠ¸ ê°œìš”

EVER-STARëŠ” ë°˜ë ¤ë™ë¬¼ì˜ ì£½ìŒ ì´í›„ ì°¾ì•„ì˜¤ëŠ” ê¹Šì€ ìŠ¬í””ì¸ **í«ë¡œìŠ¤ ì¦í›„êµ°**ì„ ê²ªëŠ” ë°˜ë ¤ë™ë¬¼ ë³´í˜¸ìë“¤ì„ ë•ê¸° ìœ„í•´ ì„¤ê³„ëœ ë”°ëœ»í•œ ì›¹ í”Œë«í¼ì…ë‹ˆë‹¤. ì´ ì„œë¹„ìŠ¤ëŠ” ì‚¬ìš©ìê°€ ë‹¤ìŒì„ í•  ìˆ˜ ìˆëŠ” ë‘ ê°œì˜ ìƒí˜¸ ì—°ê²°ëœ ê³µê°„ì„ ì œê³µí•©ë‹ˆë‹¤:

1. **ì˜êµ¬ì ì¸ ì¶”ëª¨ ê³µê°„ ë§Œë“¤ê¸°** - ì¸í„°ë™í‹°ë¸Œ ë””ì§€í„¸ ì±…ìœ¼ë¡œ
2. **ì¹˜ìœ  í€˜ìŠ¤íŠ¸ ì™„ë£Œí•˜ê¸°** - í¼ì¦, í™”ìƒ í†µí™”, í¸ì§€ ì“°ê¸°ë¥¼ í†µí•´
3. **ë‹¤ë¥¸ ì‚¬ëŒë“¤ê³¼ ì—°ê²°í•˜ê¸°** - ë°˜ë ¤ë™ë¬¼ì„ ìƒì€ ë…íŠ¹í•œ ê³ í†µì„ ì´í•´í•˜ëŠ” ì‚¬ëŒë“¤ê³¼

**ê°œë°œ ê¸°ê°„**: 2024ë…„ 1ì›” - 2ì›” (8ì£¼)

**íŒ€**: ê°œë°œì 5ëª… (í”„ë¡ íŠ¸ì—”ë“œ 3, ë°±ì—”ë“œ 2)

## ë‚˜ì˜ ì—­í• : í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œì

ì„¸ ëª…ì˜ í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œì ì¤‘ í•œ ëª…ìœ¼ë¡œì„œ ì»´í¬ë„ŒíŠ¸ ì•„í‚¤í…ì²˜ì™€ ì¸í„°ë™í‹°ë¸Œ ê¸°ëŠ¥ êµ¬ì¶•ì— ì§‘ì¤‘í–ˆìŠµë‹ˆë‹¤:

### ì£¼ìš” ì±…ì„ì‚¬í•­
- **Atomic Design êµ¬í˜„** - 265ê°œ ì´ìƒì˜ React ì»´í¬ë„ŒíŠ¸
- **ì¶”ëª¨ ì±… ì‹œìŠ¤í…œ** - ì‹¤ê°ë‚˜ëŠ” í˜ì´ì§€ ë„˜ê¹€ ì• ë‹ˆë©”ì´ì…˜
- **í€˜ìŠ¤íŠ¸ ì‹œìŠ¤í…œ** - í¼ì¦ ê²Œì„ ë° í™”ìƒ ì±„íŒ… í†µí•© í¬í•¨
- **ìƒíƒœ ê´€ë¦¬** - Redux Toolkit + React Query
- **Storybook ë¬¸ì„œí™”** - ì»´í¬ë„ŒíŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬

## ê¸°ìˆ  ìŠ¤íƒ ì‹¬ì¸µ ë¶„ì„

### í”„ë¡ íŠ¸ì—”ë“œ ì•„í‚¤í…ì²˜

**í•µì‹¬ í”„ë ˆì„ì›Œí¬**: React 18 (Create React App)

```json
// package.json - ì£¼ìš” ì˜ì¡´ì„±
{
  "dependencies": {
    "react": "^18.3.1",
    "react-router-dom": "^6.24.1",

    // ìƒíƒœ ê´€ë¦¬
    "@reduxjs/toolkit": "^2.2.6",
    "@tanstack/react-query": "^5.51.21",
    "redux-persist": "^6.0.0",

    // ìŠ¤íƒ€ì¼ë§
    "styled-components": "^6.1.12",
    "tailwindcss": "^3.4.0",
    "framer-motion": "^11.3.19",

    // íŠ¹ìˆ˜ ê¸°ëŠ¥
    "react-pageflip": "^2.0.3",  // ì±… í˜ì´ì§€ ë„˜ê¸°ê¸°
    "konva": "^9.3.14",          // í¼ì¦ìš© ìº”ë²„ìŠ¤
    "headbreaker": "^3.0.0",     // í¼ì¦ ìƒì„±
    "openvidu-browser": "^2.30.1", // í™”ìƒ ì±„íŒ…

    // ì‹¤ì‹œê°„ í†µì‹ 
    "@stomp/stompjs": "^7.0.0",
    "sockjs-client": "^1.6.1",

    // PDF ìƒì„±
    "html2canvas": "^1.4.1",
    "jspdf": "^2.5.1",
    "@react-pdf/renderer": "^3.4.4",

    // UI ë¼ì´ë¸ŒëŸ¬ë¦¬
    "sweetalert2": "^11.12.4",
    "react-datepicker": "^7.3.0",
    "react-slick": "^0.30.2"
  }
}
```

### ë°±ì—”ë“œ (Spring Boot 3.3.1)

**ì°¸ê³ **: í”„ë¡ íŠ¸ì—”ë“œì— ì§‘ì¤‘í–ˆì§€ë§Œ, ë°±ì—”ë“œ ì´í•´ê°€ í†µí•©ì— ë„ì›€ì´ ë˜ì—ˆìŠµë‹ˆë‹¤.

```gradle
// everStarBackAuth/build.gradle
dependencies {
    // Spring Boot 3.3.1
    implementation 'org.springframework.boot:spring-boot-starter-web'
    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'

    // Security & OAuth2
    implementation 'org.springframework.boot:spring-boot-starter-security'
    implementation 'org.springframework.boot:spring-boot-starter-oauth2-client'

    // Database
    runtimeOnly 'com.mysql:mysql-connector-j'
    implementation 'org.springframework.boot:spring-boot-starter-data-redis'

    // Lombok
    compileOnly 'org.projectlombok:lombok'
}
```

## Atomic Design ì•„í‚¤í…ì²˜

Atomic Design ë°©ë²•ë¡ ì„ ì‚¬ìš©í•˜ì—¬ 265ê°œ ì´ìƒì˜ ì»´í¬ë„ŒíŠ¸ë¥¼ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤:

```
src/components/
â”œâ”€â”€ atoms/              # 80ê°œ ì´ìƒì˜ ê¸°ë³¸ ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ buttons/       # PrimaryButton, Toggle, Tag ë“±
â”‚   â”œâ”€â”€ icons/         # Arrow, Chat, Profile ë“±
â”‚   â”œâ”€â”€ symbols/       # Logo, Book, Letter, Rainbow ë“±
â”‚   â””â”€â”€ texts/         # Label, Message, LetterText ë“±
â”‚
â”œâ”€â”€ molecules/         # 60ê°œ ì´ìƒì˜ ë³µí•© ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ cards/         # LetterCard, PostItCard, PetCard
â”‚   â”œâ”€â”€ inputs/        # TextField, DatePicker, SearchBar
â”‚   â””â”€â”€ Footer/        # ë„¤ë¹„ê²Œì´ì…˜ í‘¸í„°
â”‚
â”œâ”€â”€ organisms/         # 40ê°œ ì´ìƒì˜ ë³µì¡í•œ ì„¹ì…˜
â”‚   â”œâ”€â”€ headers/       # PageHeader, ProfileHeader
â”‚   â”œâ”€â”€ forms/         # LoginForm, SignUpForm
â”‚   â””â”€â”€ lists/         # LetterList, QuestList
â”‚
â””â”€â”€ templates/         # 35ê°œ ì´ìƒì˜ í˜ì´ì§€ ë ˆì´ì•„ì›ƒ
    â”œâ”€â”€ EarthMain.tsx          # ì§€êµ¬ë³„ í™ˆ
    â”œâ”€â”€ EverStarMain.tsx       # ì˜ì›ë³„ í™ˆ
    â”œâ”€â”€ MemorialBook.tsx       # í”Œë¦½ë¶ ì¶”ëª¨
    â”œâ”€â”€ LetterWriteTemplate.tsx
    â”œâ”€â”€ QuestPuzzle.tsx
    â””â”€â”€ QuestOpenviduTemplate.tsx
```

### Atomic Designì„ ì„ íƒí•œ ì´ìœ ?

**ìš°ë¦¬ê°€ ê²½í—˜í•œ ì´ì **:
- **ì¬ì‚¬ìš©ì„±**: 50ê°œ ì´ìƒì˜ í™”ë©´ì—ì„œ ì‚¬ìš©ë˜ëŠ” ë²„íŠ¼
- **ì¼ê´€ì„±**: ëª¨ë“  ê³³ì—ì„œ ë™ì¼í•œ `Avatar` ì»´í¬ë„ŒíŠ¸
- **íŒ€ í˜‘ì—…**: ì»´í¬ë„ŒíŠ¸ ì¶©ëŒ ì—†ìŒ
- **Storybook í†µí•©**: ì‰¬ìš´ ë¬¸ì„œí™”

**ì»´í¬ë„ŒíŠ¸ ê³„ì¸µ êµ¬ì¡° ì˜ˆì‹œ**:
```
Template: MemorialBook
  â””â”€ Organism: BookPages
      â””â”€ Molecule: PageContent
          â”œâ”€ Atom: Avatar
          â”œâ”€ Atom: Label
          â””â”€ Atom: LetterText
```

## ë‚´ê°€ êµ¬ì¶•í•œ ì£¼ìš” ê¸°ëŠ¥

### 1. í˜ì´ì§€ ë„˜ê¹€ ì• ë‹ˆë©”ì´ì…˜ì´ ìˆëŠ” ì¶”ëª¨ ì±…

**ê³¼ì œ**: ì‹¤ê°ë‚˜ëŠ” ì±… ì½ê¸° ê²½í—˜ ë§Œë“¤ê¸°

**í•´ê²°ì±…**: `react-pageflip` ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©

```tsx
// components/templates/MemorialBook.tsx
import HTMLFlipBook from "react-pageflip";
import { useRef, useState } from "react";

interface MemorialBookProps {
  avatarUrl: string;
  isOwner: boolean;
}

export const MemorialBook: React.FC<MemorialBookProps> = ({
  avatarUrl,
  isOwner
}) => {
  const bookRef = useRef<any>(null);
  const [currentPage, setCurrentPage] = useState(0);

  // ì¶”ëª¨ ì±… ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
  const { data: bookData } = useFetchMemorialBook();

  const handlePageFlip = (e: any) => {
    setCurrentPage(e.data);
  };

  return (
    <div className="memorial-book-container">
      <HTMLFlipBook
        ref={bookRef}
        width={400}
        height={600}
        size="fixed"
        minWidth={300}
        maxWidth={800}
        minHeight={400}
        maxHeight={1000}
        drawShadow={true}
        flippingTime={1000}
        usePortrait={true}
        startZIndex={0}
        autoSize={false}
        maxShadowOpacity={0.5}
        showCover={true}
        mobileScrollSupport={true}
        onFlip={handlePageFlip}
        className="flip-book"
      >
        {/* í‘œì§€ */}
        <div className="page cover-page">
          <img src={avatarUrl} alt="Pet" />
          <h1>{bookData?.petName}</h1>
          <p>{bookData?.memorialDate}</p>
        </div>

        {/* ë‚´ìš© í˜ì´ì§€ */}
        {bookData?.pages.map((page, index) => (
          <div key={index} className="page">
            <div className="page-content">
              <h2>{page.title}</h2>
              {page.imageUrl && (
                <img
                  src={page.imageUrl}
                  alt={page.title}
                  className="page-image"
                />
              )}
              <p className="page-text">{page.content}</p>

              {/* í•˜ë‹¨ í˜ì´ì§€ ë²ˆí˜¸ */}
              <div className="page-footer">
                <span className="page-number">{index + 1}</span>
              </div>
            </div>
          </div>
        ))}

        {/* ë’·í‘œì§€ */}
        <div className="page back-cover">
          <div className="memories-summary">
            <p>ì‚¬ë‘ìœ¼ë¡œ ë§Œë“¤ì–´ì§„</p>
            <p>{bookData?.totalMemories}ê°œì˜ ì¶”ì–µì´ ë³´ì¡´ë¨</p>
          </div>
        </div>
      </HTMLFlipBook>

      {/* ë„¤ë¹„ê²Œì´ì…˜ ì»¨íŠ¸ë¡¤ */}
      <div className="book-controls">
        <button
          onClick={() => bookRef.current?.pageFlip().flipPrev()}
          disabled={currentPage === 0}
        >
          ì´ì „
        </button>

        <span className="page-indicator">
          {currentPage + 1} / {bookData?.pages.length} í˜ì´ì§€
        </span>

        <button
          onClick={() => bookRef.current?.pageFlip().flipNext()}
          disabled={currentPage === bookData?.pages.length - 1}
        >
          ë‹¤ìŒ
        </button>
      </div>
    </div>
  );
};
```

**emotionìœ¼ë¡œ ìŠ¤íƒ€ì¼ë§**:
```tsx
// ì±…ì„ ìœ„í•œ ìŠ¤íƒ€ì¼ ì»´í¬ë„ŒíŠ¸
const BookContainer = styled.div`
  perspective: 1500px;

  .flip-book {
    margin: 50px auto;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
  }

  .page {
    background: linear-gradient(
      to bottom,
      #f4f1e8 0%,
      #ebe6d9 100%
    );
    padding: 40px;
    border: 1px solid #d4cfc0;

    /* ì¢…ì´ ì§ˆê° */
    background-image: url('data:image/svg+xml,...');
  }

  .cover-page {
    background: linear-gradient(
      135deg,
      #667eea 0%,
      #764ba2 100%
    );
    color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }
`;
```

**ê²°ê³¼**: ì‚¬ìš©ìê°€ ì‹¤ì œ ì‚¬ì§„ ì•¨ë²”ì²˜ëŸ¼ ì¶”ëª¨ í˜ì´ì§€ë¥¼ ë„˜ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤!

### 2. ì¸í„°ë™í‹°ë¸Œ í¼ì¦ í€˜ìŠ¤íŠ¸

**ê³¼ì œ**: ìŠ¬í”” ì¹˜ìœ ë¥¼ ìœ„í•œ ë§¤ë ¥ì ì¸ í™œë™ ë§Œë“¤ê¸°

**í•´ê²°ì±…**: Konva + Headbreakerë¥¼ ì‚¬ìš©í•œ ìº”ë²„ìŠ¤ ê¸°ë°˜ ì§ì†Œ í¼ì¦

```tsx
// components/templates/QuestPuzzle.tsx
import { Stage, Layer, Image as KonvaImage } from 'react-konva';
import { Canvas, Puzzle } from 'headbreaker';
import { useEffect, useRef, useState } from 'react';

export const QuestPuzzle: React.FC = () => {
  const [puzzle, setPuzzle] = useState<Puzzle | null>(null);
  const [isComplete, setIsComplete] = useState(false);
  const canvasRef = useRef<HTMLCanvasElement>(null);

  useEffect(() => {
    if (!canvasRef.current) return;

    // ë°˜ë ¤ë™ë¬¼ ì´ë¯¸ì§€ì—ì„œ í¼ì¦ ìƒì„±
    const image = new window.Image();
    image.src = '/assets/pet-photo.jpg';

    image.onload = () => {
      const canvas = new Canvas(canvasRef.current!.id, {
        width: 800,
        height: 600,
        pieceSize: 100,
        proximity: 20,
        borderFill: 10,
        strokeWidth: 2,
        lineSoftness: 0.18
      });

      // í¼ì¦ ì¡°ê° ìƒì„±
      const newPuzzle = canvas.autogenerate({
        horizontalPiecesCount: 4,
        verticalPiecesCount: 3,
        insertsGenerator: (x, y) => ({
          right: Math.random() > 0.5 ? 1 : -1,
          bottom: Math.random() > 0.5 ? 1 : -1
        })
      });

      // ì¡°ê° ì„ê¸°
      newPuzzle.shuffleGrid();

      // ìº”ë²„ìŠ¤ì— ê·¸ë¦¬ê¸°
      newPuzzle.draw();

      // ì™„ì„± ë¦¬ìŠ¤ë„ˆ
      newPuzzle.onConnect((piece, target) => {
        if (newPuzzle.isValid()) {
          setIsComplete(true);
          onPuzzleComplete();
        }
      });

      setPuzzle(newPuzzle);
    };
  }, []);

  const onPuzzleComplete = async () => {
    // í€˜ìŠ¤íŠ¸ë¥¼ ì™„ë£Œë¡œ í‘œì‹œ
    await markQuestComplete({
      questId: 'puzzle-quest-1',
      completionTime: Date.now()
    });

    // ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
    Swal.fire({
      title: 'í€˜ìŠ¤íŠ¸ ì™„ë£Œ!',
      text: 'ì¶”ì–µ í¼ì¦ì„ ì™„ì„±í–ˆìŠµë‹ˆë‹¤',
      icon: 'success',
      confirmButtonText: 'ê³„ì†í•˜ê¸°'
    });
  };

  return (
    <div className="puzzle-container">
      <h2>ì¶”ì–µ í¼ì¦ í€˜ìŠ¤íŠ¸</h2>
      <p>ì‚¬ë‘í•˜ëŠ” ë°˜ë ¤ë™ë¬¼ì˜ ì´ ì‚¬ì§„ì„ ë§ì¶°ë³´ì„¸ìš”</p>

      <canvas
        ref={canvasRef}
        id="puzzle-canvas"
        width={800}
        height={600}
      />

      {isComplete && (
        <div className="completion-message">
          <h3>ì•„ë¦„ë‹¤ìš´ ì¶”ì–µì´ ë³´ì¡´ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸŒŸ</h3>
          <button onClick={() => router.push('/earth')}>
            ì§€êµ¬ë³„ë¡œ ëŒì•„ê°€ê¸°
          </button>
        </div>
      )}
    </div>
  );
};
```

### 3. ì‹¤ì‹œê°„ í™”ìƒ ì±„íŒ… í€˜ìŠ¤íŠ¸

**ê³¼ì œ**: ë°˜ë ¤ë™ë¬¼ì„ ìƒì€ ë‹¤ë¥¸ ì‚¬ëŒë“¤ê³¼ ëŒ€í™”í•  ìˆ˜ ìˆê²Œ í•˜ê¸°

**í•´ê²°ì±…**: ê·¸ë£¹ í™”ìƒ í†µí™”ë¥¼ ìœ„í•œ OpenVidu í†µí•©

```tsx
// components/templates/QuestOpenviduTemplate.tsx
import { OpenVidu, Session, StreamManager } from 'openvidu-browser';
import { useEffect, useRef, useState } from 'react';

export const QuestOpenviduTemplate: React.FC = () => {
  const [session, setSession] = useState<Session | null>(null);
  const [publisher, setPublisher] = useState<StreamManager | null>(null);
  const [subscribers, setSubscribers] = useState<StreamManager[]>([]);
  const OV = useRef<OpenVidu | null>(null);

  useEffect(() => {
    joinSession();

    return () => {
      leaveSession();
    };
  }, []);

  const joinSession = async () => {
    // OpenVidu ì´ˆê¸°í™”
    OV.current = new OpenVidu();
    const newSession = OV.current.initSession();

    // ìŠ¤íŠ¸ë¦¼ ì´ë²¤íŠ¸ êµ¬ë…
    newSession.on('streamCreated', (event) => {
      const subscriber = newSession.subscribe(event.stream, undefined);
      setSubscribers((prev) => [...prev, subscriber]);
    });

    newSession.on('streamDestroyed', (event) => {
      setSubscribers((prev) =>
        prev.filter((sub) => sub !== event.stream.streamManager)
      );
    });

    // ë°±ì—”ë“œì—ì„œ í† í° ê°€ì ¸ì˜¤ê¸°
    const token = await getToken('grief-support-room');

    // ì„¸ì…˜ ì—°ê²°
    await newSession.connect(token, { clientData: 'User' });

    // ìì‹ ì˜ ë¹„ë””ì˜¤/ì˜¤ë””ì˜¤ ê²Œì‹œ
    const newPublisher = await OV.current.initPublisherAsync(undefined, {
      audioSource: undefined,
      videoSource: undefined,
      publishAudio: true,
      publishVideo: true,
      resolution: '640x480',
      frameRate: 30,
      insertMode: 'APPEND',
      mirror: false
    });

    newSession.publish(newPublisher);

    setSession(newSession);
    setPublisher(newPublisher);
  };

  const leaveSession = () => {
    if (session) {
      session.disconnect();
    }
    setSession(null);
    setPublisher(null);
    setSubscribers([]);
  };

  const toggleAudio = () => {
    if (publisher) {
      publisher.publishAudio(!publisher.stream.audioActive);
    }
  };

  const toggleVideo = () => {
    if (publisher) {
      publisher.publishVideo(!publisher.stream.videoActive);
    }
  };

  return (
    <div className="video-chat-container">
      <h2>ì§€ì§€ ê·¸ë£¹ í™”ìƒ í†µí™”</h2>

      <div className="video-grid">
        {/* ìì‹ ì˜ ë¹„ë””ì˜¤ (ê²Œì‹œì) */}
        {publisher && (
          <div className="video-wrapper own-video">
            <video
              ref={(video) => {
                if (video) publisher.addVideoElement(video);
              }}
              autoPlay
              playsInline
            />
            <span className="video-label">ë‚˜</span>
          </div>
        )}

        {/* ë‹¤ë¥¸ ì°¸ê°€ì (êµ¬ë…ì) */}
        {subscribers.map((sub, index) => (
          <div key={index} className="video-wrapper">
            <video
              ref={(video) => {
                if (video) sub.addVideoElement(video);
              }}
              autoPlay
              playsInline
            />
            <span className="video-label">
              ì°¸ê°€ì {index + 1}
            </span>
          </div>
        ))}
      </div>

      {/* ì»¨íŠ¸ë¡¤ */}
      <div className="video-controls">
        <button onClick={toggleAudio}>
          <MicrophoneIcon />
          {publisher?.stream.audioActive ? 'ìŒì†Œê±°' : 'ìŒì†Œê±° í•´ì œ'}
        </button>

        <button onClick={toggleVideo}>
          <VideoIcon />
          {publisher?.stream.videoActive ? 'ë¹„ë””ì˜¤ ì¤‘ì§€' : 'ë¹„ë””ì˜¤ ì‹œì‘'}
        </button>

        <button onClick={leaveSession} className="leave-button">
          <PhoneStopIcon />
          í†µí™” ì¢…ë£Œ
        </button>
      </div>
    </div>
  );
};
```

### 4. í¸ì§€ ì“°ê¸° ì‹œìŠ¤í…œ

**ì§€êµ¬ë³„ ê¸°ëŠ¥**: ë– ë‚œ ë°˜ë ¤ë™ë¬¼ì—ê²Œ ì¹˜ìœ  í¸ì§€ ì“°ê¸°

```tsx
// components/templates/LetterWriteTemplate.tsx
import { useState } from 'react';
import { useSelector } from 'react-redux';
import styled from 'styled-components';

export const LetterWriteTemplate: React.FC = () => {
  const petDetails = useSelector((state: RootState) => state.pet.petDetails);
  const [content, setContent] = useState('');
  const [mood, setMood] = useState<'sad' | 'nostalgic' | 'grateful' | 'peaceful'>('nostalgic');

  const handleSubmit = async () => {
    // ë°±ì—”ë“œì— í¸ì§€ ì €ì¥
    const letter = await createLetter({
      petId: petDetails.id,
      content,
      mood,
      isPrivate: true  // ê¸°ë³¸ ë¹„ê³µê°œ
    });

    // ì„±ê³µ ì• ë‹ˆë©”ì´ì…˜ í‘œì‹œ
    await Swal.fire({
      title: 'í¸ì§€ ì „ì†¡ë¨',
      text: `${petDetails.name}ì—ê²Œ ë³´ë‚´ëŠ” í¸ì§€ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤`,
      icon: 'success',
      timer: 2000,
      showConfirmButton: false
    });

    // í¸ì§€ ìƒì„¸ë¡œ ì´ë™
    router.push(`/earth/letter/${letter.id}`);
  };

  return (
    <LetterContainer>
      <h2>{petDetails?.name}ì—ê²Œ í¸ì§€ ì“°ê¸°</h2>

      {/* ê¸°ë¶„ ì„ íƒ */}
      <MoodSelector>
        <label>ì§€ê¸ˆ ê¸°ë¶„ì´ ì–´ë– ì‹ ê°€ìš”?</label>
        <div className="mood-buttons">
          {[
            { value: 'sad', emoji: 'ğŸ˜¢', label: 'ìŠ¬í””' },
            { value: 'nostalgic', emoji: 'ğŸŒ¸', label: 'ê·¸ë¦¬ì›€' },
            { value: 'grateful', emoji: 'ğŸ’–', label: 'ê°ì‚¬í•¨' },
            { value: 'peaceful', emoji: 'ğŸ•Šï¸', label: 'í‰ì˜¨í•¨' }
          ].map((option) => (
            <button
              key={option.value}
              onClick={() => setMood(option.value as any)}
              className={mood === option.value ? 'active' : ''}
            >
              <span className="emoji">{option.emoji}</span>
              <span>{option.label}</span>
            </button>
          ))}
        </div>
      </MoodSelector>

      {/* í¸ì§€ì§€ */}
      <LetterPaper>
        <div className="letter-header">
          <p>ì‚¬ë‘í•˜ëŠ” {petDetails?.name}ì—ê²Œ,</p>
        </div>

        <textarea
          value={content}
          onChange={(e) => setContent(e.target.value)}
          placeholder="ë‹¹ì‹ ì˜ ìƒê°ê³¼ ê°ì •ì„ ì ì–´ë³´ì„¸ìš”..."
          rows={15}
        />

        <div className="letter-footer">
          <p>ì‚¬ë‘ì„ ë‹´ì•„,</p>
          <p className="signature">ë‹¹ì‹ ì˜ ê°€ì¡±ì´</p>
        </div>
      </LetterPaper>

      {/* ì•¡ì…˜ */}
      <div className="letter-actions">
        <button onClick={() => router.back()} className="cancel">
          ì·¨ì†Œ
        </button>
        <button
          onClick={handleSubmit}
          disabled={content.length < 10}
          className="submit"
        >
          í¸ì§€ ë³´ë‚´ê¸°
        </button>
      </div>
    </LetterContainer>
  );
};

const LetterPaper = styled.div`
  background: linear-gradient(to bottom, #fffef7 0%, #f7f4e8 100%);
  padding: 40px;
  border: 1px solid #d4cfc0;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
  margin: 30px 0;

  /* ì¤„ë¬´ëŠ¬ ì¢…ì´ íš¨ê³¼ */
  background-image:
    repeating-linear-gradient(
      transparent,
      transparent 30px,
      #e8e3d3 30px,
      #e8e3d3 31px
    );

  textarea {
    width: 100%;
    border: none;
    background: transparent;
    font-family: 'Noto Sans KR', sans-serif;
    font-size: 16px;
    line-height: 31px;  // ì¤„ë¬´ëŠ¬ì™€ ë§ì¶¤
    resize: none;
    outline: none;
    color: #333;
  }
`;
```

## ìƒíƒœ ê´€ë¦¬ ì „ëµ

**Redux Toolkit** (ì „ì—­ ìƒíƒœ) + **React Query** (ì„œë²„ ìƒíƒœ):

```tsx
// store/petSlice.ts
import { createSlice, PayloadAction } from '@reduxjs/toolkit';

interface PetState {
  petDetails: PetDetails | null;
  selectedMemorialBookId: number | null;
}

const initialState: PetState = {
  petDetails: null,
  selectedMemorialBookId: null
};

export const petSlice = createSlice({
  name: 'pet',
  initialState,
  reducers: {
    setPetDetails: (state, action: PayloadAction<PetDetails>) => {
      state.petDetails = action.payload;
    },
    setMemorialBookId: (state, action: PayloadAction<number>) => {
      state.selectedMemorialBookId = action.payload;
    },
    clearPetData: (state) => {
      state.petDetails = null;
      state.selectedMemorialBookId = null;
    }
  }
});

export const { setPetDetails, setMemorialBookId, clearPetData } = petSlice.actions;
```

```tsx
// hooks/useEverStar.ts
import { useQuery } from '@tanstack/react-query';
import axios from 'axios';

export const useFetchOtherPetDetails = (petId: number) => {
  return useQuery({
    queryKey: ['petDetails', petId],
    queryFn: async () => {
      const { data } = await axios.get(`/api/pets/${petId}`);
      return data;
    },
    enabled: petId > 0,
    staleTime: 5 * 60 * 1000,  // 5ë¶„
    cacheTime: 10 * 60 * 1000  // 10ë¶„
  });
};

export const useFetchMemorialBooksWithQuest = (petId: number, questIndex: number) => {
  return useQuery({
    queryKey: ['memorialBooks', petId, questIndex],
    queryFn: async () => {
      const { data } = await axios.get(
        `/api/memorial-books?petId=${petId}&questIndex=${questIndex}`
      );
      return data;
    },
    enabled: petId > 0
  });
};
```

**ì´ ì¡°í•©ì„ ì„ íƒí•œ ì´ìœ ?**
- **Redux**: ì‚¬ìš©ì ì¸ì¦, í˜„ì¬ ë°˜ë ¤ë™ë¬¼ ì„ íƒ, UI ìƒíƒœ
- **React Query**: ìë™ ìºì‹± ë° ì¬í˜ì¹­ì´ ìˆëŠ” API í˜¸ì¶œ
- **Redux Persist**: ì„¸ì…˜ ê°„ ë°˜ë ¤ë™ë¬¼ ì„ íƒ ì €ì¥

## ì‹¤ì‹œê°„ ê¸°ëŠ¥

**STOMP WebSocket**ì„ í†µí•œ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸:

```tsx
// hooks/useWebSocket.ts
import { Client } from '@stomp/stompjs';
import SockJS from 'sockjs-client';
import { useEffect, useRef } from 'react';

export const useCheeringMessages = (petId: number) => {
  const clientRef = useRef<Client | null>(null);

  useEffect(() => {
    const socket = new SockJS('/ws');
    const stompClient = new Client({
      webSocketFactory: () => socket,
      reconnectDelay: 5000,
      heartbeatIncoming: 4000,
      heartbeatOutgoing: 4000
    });

    stompClient.onConnect = () => {
      // ì´ ë°˜ë ¤ë™ë¬¼ì— ëŒ€í•œ ì‘ì› ë©”ì‹œì§€ êµ¬ë…
      stompClient.subscribe(`/topic/cheering/${petId}`, (message) => {
        const newMessage = JSON.parse(message.body);
        queryClient.invalidateQueries(['cheeringMessages', petId]);
      });
    };

    stompClient.activate();
    clientRef.current = stompClient;

    return () => {
      stompClient.deactivate();
    };
  }, [petId]);
};
```

## ì„±ëŠ¥ ìµœì í™”

### 1. React.lazyë¥¼ ì‚¬ìš©í•œ ì½”ë“œ ë¶„í• 

```tsx
// App.tsx
import { lazy, Suspense } from 'react';

const EarthPage = lazy(() => import('./pages/EarthPage'));
const EverstarPage = lazy(() => import('./pages/EverstarPage'));
const MyPage = lazy(() => import('./pages/MyPage'));

function App() {
  return (
    <Suspense fallback={<SplashTemplate />}>
      <Routes>
        <Route path="/earth/*" element={<EarthPage />} />
        <Route path="/everstar/:pet?" element={<EverstarPage />} />
        <Route path="/mypage" element={<MyPage />} />
      </Routes>
    </Suspense>
  );
}
```

### 2. ì´ë¯¸ì§€ ìµœì í™”

```tsx
// 265ê°œ ì´ìƒì˜ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‚¬ìš©
const OptimizedImage: React.FC<{ src: string; alt: string }> = ({ src, alt }) => {
  const [loaded, setLoaded] = useState(false);

  return (
    <div className="image-container">
      {!loaded && <Skeleton />}
      <img
        src={src}
        alt={alt}
        onLoad={() => setLoaded(true)}
        loading="lazy"
        style={{ display: loaded ? 'block' : 'none' }}
      />
    </div>
  );
};
```

## Storybookì„ í†µí•œ ì»´í¬ë„ŒíŠ¸ ë¬¸ì„œí™”

**ëª¨ë“  265ê°œ ì»´í¬ë„ŒíŠ¸ ë¬¸ì„œí™”**:

```tsx
// Button.stories.tsx
import type { Meta, StoryObj } from '@storybook/react';
import { PrimaryButton } from './PrimaryButton';

const meta: Meta<typeof PrimaryButton> = {
  title: 'Atoms/Buttons/PrimaryButton',
  component: PrimaryButton,
  tags: ['autodocs'],
  argTypes: {
    size: {
      control: 'select',
      options: ['small', 'medium', 'large']
    },
    disabled: {
      control: 'boolean'
    }
  }
};

export default meta;
type Story = StoryObj<typeof PrimaryButton>;

export const Default: Story = {
  args: {
    children: 'í´ë¦­í•˜ì„¸ìš”',
    size: 'medium',
    disabled: false
  }
};

export const Disabled: Story = {
  args: {
    children: 'ë¹„í™œì„±í™”ëœ ë²„íŠ¼',
    disabled: true
  }
};
```

**Storybook ì‹¤í–‰**:
```bash
npm run storybook
# http://localhost:6006ì—ì„œ ì—´ë¦¼
```

## ê³¼ì œ ë° í•´ê²°ì±…

### ê³¼ì œ 1: ì±… í˜ì´ì§€ ì„±ëŠ¥

**ë¬¸ì œ**: ê³ í•´ìƒë„ ì´ë¯¸ì§€ë¡œ ì¸í•œ í”Œë¦½ ì• ë‹ˆë©”ì´ì…˜ ì§€ì—°

**í•´ê²°ì±…**:
```tsx
// ë Œë”ë§ ì „ ì´ë¯¸ì§€ ì‚¬ì „ ë¡œë“œ
const preloadImages = async (imageUrls: string[]) => {
  const promises = imageUrls.map((url) => {
    return new Promise((resolve) => {
      const img = new Image();
      img.src = url;
      img.onload = resolve;
    });
  });

  await Promise.all(promises);
};

useEffect(() => {
  if (bookData) {
    const images = bookData.pages.map((p) => p.imageUrl).filter(Boolean);
    preloadImages(images);
  }
}, [bookData]);
```

### ê³¼ì œ 2: OpenVidu ì—°ê²° ì•ˆì •ì„±

**ë¬¸ì œ**: ëª¨ë°”ì¼ì—ì„œ í™”ìƒ í†µí™” ëŠê¹€

**í•´ê²°ì±…**: ì¬ì—°ê²° ë¡œì§ êµ¬í˜„
```tsx
const handleReconnect = async () => {
  try {
    await leaveSession();
    await new Promise((resolve) => setTimeout(resolve, 1000));
    await joinSession();
  } catch (error) {
    console.error('ì¬ì—°ê²° ì‹¤íŒ¨:', error);
  }
};

// ì—°ê²° ë¬¸ì œ ì‹œ ìë™ ì¬ì—°ê²°
session.on('connectionDestroyed', (event) => {
  if (event.reason === 'networkDisconnect') {
    handleReconnect();
  }
});
```

### ê³¼ì œ 3: ìƒíƒœ ì§€ì†ì„±

**ë¬¸ì œ**: ìƒˆë¡œê³ ì¹¨ ì‹œ ì‚¬ìš©ìê°€ ë°˜ë ¤ë™ë¬¼ ì„ íƒ ìƒìŒ

**í•´ê²°ì±…**: Redux Persist
```tsx
// store/Store.ts
import { persistStore, persistReducer } from 'redux-persist';
import storage from 'redux-persist/lib/storage';

const persistConfig = {
  key: 'root',
  storage,
  whitelist: ['pet', 'auth']  // ì´ ìŠ¬ë¼ì´ìŠ¤ë§Œ ì§€ì†
};

const persistedReducer = persistReducer(persistConfig, rootReducer);

export const store = configureStore({
  reducer: persistedReducer,
  middleware: (getDefaultMiddleware) =>
    getDefaultMiddleware({
      serializableCheck: {
        ignoredActions: [FLUSH, REHYDRATE, PAUSE, PERSIST, PURGE, REGISTER]
      }
    })
});

export const persistor = persistStore(store);
```

## ë°°ìš´ ì 

### 1. Atomic Designì˜ í™•ì¥ì„±

265ê°œ ì´ìƒì˜ ì»´í¬ë„ŒíŠ¸ë¡œ êµ¬ì„±ì´ ì¤‘ìš”í–ˆìŠµë‹ˆë‹¤:
- **ëª…í™•í•œ ë„¤ì´ë°**: ë‹¨ìˆœíˆ `Button`ì´ ì•„ë‹Œ `PrimaryButton`
- **ì¼ê´€ëœ props**: ëª¨ë“  ë²„íŠ¼ì´ `size`, `disabled`, `onClick` ê³µìœ 
- **Storybook ë¬¸ì„œí™”**: íŒ€ í˜‘ì—…ì— í•„ìˆ˜ì 

### 2. React Query > ìˆ˜ë™ í˜ì¹­

React Query ì´ì „:
```tsx
// ìˆ˜ë™ ìºì‹± ì•…ëª½
const [petData, setPetData] = useState(null);
const [loading, setLoading] = useState(true);

useEffect(() => {
  fetchPet(petId).then(setPetData).finally(() => setLoading(false));
}, [petId]);
```

React Query ì´í›„:
```tsx
// ìë™ ìºì‹±, ì¬í˜ì¹­, ì—ëŸ¬ ì²˜ë¦¬
const { data, isLoading } = useFetchPetDetails(petId);
```

### 3. TypeScriptê°€ ìš°ë¦¬ë¥¼ êµ¬í–ˆë‹¤

**íƒ€ì… ì•ˆì •ì„±ìœ¼ë¡œ ìˆ˜ë§ì€ ë²„ê·¸ ë°©ì§€**:
```tsx
// ì»´íŒŒì¼ ì‹œ íƒ€ì… ì—ëŸ¬ ë°œê²¬!
<MemorialBook avatarUrl={123} />  // âŒ Type 'number'ë¥¼ type 'string'ì— í• ë‹¹í•  ìˆ˜ ì—†ìŒ

// ì˜¬ë°”ë¥¸ ì‚¬ìš©
<MemorialBook avatarUrl={petDetails.avatarUrl} />  // âœ…
```

## í”„ë¡œì íŠ¸ í†µê³„

- **ì´ ì»´í¬ë„ŒíŠ¸**: 265ê°œ TSX íŒŒì¼
- **ì½”ë“œ ë¼ì¸ ìˆ˜**: ~50,000ì¤„ (í”„ë¡ íŠ¸ì—”ë“œë§Œ)
- **ë²ˆë“¤ í¬ê¸°**: 2.8MB (gzip ì´ì „)
- **Lighthouse ì ìˆ˜**: 85 (ì„±ëŠ¥), 100 (ì ‘ê·¼ì„±)
- **ê°œë°œ ê¸°ê°„**: 8ì£¼ (í”„ë¡ íŠ¸ì—”ë“œ 3ëª…, ë°±ì—”ë“œ 2ëª…)

## í–¥í›„ ê°œì„ ì‚¬í•­

- **ëª¨ë°”ì¼ ì•±**: React Native ë²„ì „
- **ìŒì„± ë©”ì‹œì§€**: ì˜¤ë””ì˜¤ í¸ì§€ ë…¹ìŒ
- **AI ìŠ¬í”” ìƒë‹´**: GPT ê¸°ë°˜ ì±—ë´‡
- **3D ì¶”ëª¨**: Three.js ê°€ìƒ ê³µê°„

## ì†ŒìŠ¤ ì½”ë“œ

ì €ì¥ì†Œ: [GitHub - EVER-STAR](https://github.com/HyunjoJung/EVER-STAR) *(ë¹„ê³µê°œ ì•„ì¹´ì´ë¸Œ)*

---

**ë°˜ë ¤ë™ë¬¼ì„ ìƒì€ ìŠ¬í””ì„ ê²ªê³  ìˆëŠ” ëª¨ë“  ë¶„ë“¤ê»˜**: ë‹¹ì‹ ì˜ ì•„í””ì€ ì •ë‹¹í•©ë‹ˆë‹¤. ì¹˜ìœ í•˜ëŠ” ë° í•„ìš”í•œ ëª¨ë“  ì‹œê°„ì„ ê°€ì§€ì„¸ìš”.

**ì§ˆë¬¸ì´ë‚˜ í”¼ë“œë°±ì´ ìˆìœ¼ì‹ ê°€ìš”?** [GitHub](https://github.com/HyunjoJung)ì—ì„œ ì—°ë½í•´ì£¼ì„¸ìš”
